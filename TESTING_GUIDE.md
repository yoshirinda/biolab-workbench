# 🧪 BioLab Workbench 功能测试指南

## 📋 测试前准备

### 1. 启动开发服务器

```bash
cd wsl/biolab/biolab-workbench/frontend
npm run dev
```

服务器将在 http://localhost:5173 启动

### 2. 启用新功能

**方法 A: 临时测试 (推荐)**
```bash
# 在 frontend/src/main.tsx 中修改导入
# 将: import App from './App'
# 改为: import App from './App-Enhanced'
```

**方法 B: 永久启用**
```bash
cd frontend/src
mv App.tsx App-Old.tsx
mv App-Enhanced.tsx App.tsx
```

---

## ✅ 功能测试清单

### 测试 1: 拖拽导入 GenBank 文件

**步骤**:
1. 打开浏览器访问 http://localhost:5173
2. 找一个 .gb 文件 (可以用项目中的示例)
3. 直接拖拽文件到左侧"拖拽文件到此处"区域
4. 观察是否自动解析并添加到序列库

**预期结果**:
- ✅ 文件立即被解析
- ✅ 序列出现在左侧项目树中
- ✅ 右侧显示序列详细信息
- ✅ 中间显示质粒图谱

**测试文件**: 使用任何标准的 GenBank 文件

---

### 测试 2: 质粒环形图谱显示

**步骤**:
1. 导入一个环状质粒序列 (.gb 文件)
2. 点击左侧项目树中的序列名称
3. 观察中间编辑器区域

**预期结果**:
- ✅ 显示环形质粒图谱
- ✅ 特征(features)用不同颜色标注
- ✅ 可以看到基因名称
- ✅ 可以旋转和缩放

**如何验证**:
- 图谱应该是圆形的
- 特征应该有颜色标识 (CDS 通常是红色/橙色)
- 鼠标悬停在特征上应该显示详细信息

---

### 测试 3: 酶切位点分析

**步骤**:
1. 打开一个序列
2. 在 OVE 编辑器中,点击顶部工具栏的 "Tools" 按钮
3. 选择 "Find Cut Sites" 或类似选项
4. 选择常用酶 (如 EcoRI, BamHI, HindIII)

**预期结果**:
- ✅ 显示酶切位点列表
- ✅ 在序列图谱上标注切割位置
- ✅ 显示识别序列

**验证方法**:
```
如果序列包含 GAATTC,应该能找到 EcoRI 切点
如果序列包含 GGATCC,应该能找到 BamHI 切点
```

---

### 测试 4: 导出为 GenBank

**步骤**:
1. 右键点击左侧项目树中的任一序列
2. 选择 "导出为" → "GenBank (.gb)"
3. 检查下载的文件

**预期结果**:
- ✅ 文件自动下载
- ✅ 文件名为 `序列名称.gb`
- ✅ 用文本编辑器打开,格式正确
- ✅ 包含 LOCUS, FEATURES, ORIGIN 等标准节

**如何验证**:
```bash
# 打开下载的 .gb 文件
cat ~/Downloads/pFA6a-GFP.gb

# 应该看到类似内容:
# LOCUS       pFA6a-GFP(S65T)-kanMX6
# DEFINITION  ...
# FEATURES             Location/Qualifiers
#      CDS             1..720
#                      /label="GFP(S65T)"
# ORIGIN
#      1 atggctagca aaggagaaga acttttcact ...
```

---

### 测试 5: 导出为 FASTA

**步骤**:
1. 右键点击序列
2. 选择 "导出为" → "FASTA (.fasta)"
3. 检查下载的文件

**预期结果**:
- ✅ FASTA 格式正确
- ✅ 包含 header (以 > 开头)
- ✅ 序列每行 60-80 个字符

**验证内容**:
```
>pFA6a-GFP(S65T)-kanMX6 描述信息
ATGGCTAGCAAAGGAGAAGAACTTTTCACTGGAGTTGTCCCAATTCTTGTTGAATTAGATGGTGAT
GTTAATGGGCACAAATTTTCTGTCAGTGGAGAGGGTGAAGGTGATGCAACATACGGAAAACTTACC
...
```

---

### 测试 6: ORF 查找

**步骤**:
1. 打开一个序列
2. 在 OVE 工具栏点击 "ORF" 或 "Find ORFs"
3. 设置最小 ORF 长度 (如 100 bp)

**预期结果**:
- ✅ 显示所有可能的 ORF
- ✅ 标注在序列图谱上
- ✅ 显示起始密码子和终止密码子位置

---

### 测试 7: 序列翻译

**步骤**:
1. 选择一段 DNA 序列
2. 在 OVE 中查看 "Translations" 轨道
3. 或使用翻译工具

**预期结果**:
- ✅ 显示 6 个阅读框的翻译结果
- ✅ 正确显示氨基酸序列
- ✅ 标注终止密码子 (*)

---

### 测试 8: 特征编辑

**步骤**:
1. 在 OVE 编辑器中,选择一段序列
2. 右键或使用工具添加新特征
3. 设置特征名称、类型、颜色

**预期结果**:
- ✅ 新特征立即显示在图谱上
- ✅ 颜色正确应用
- ✅ 保存后特征保留

---

### 测试 9: 批量导入

**步骤**:
1. 同时选择多个 .gb 或 .fasta 文件
2. 拖拽到上传区域
3. 或使用"导入"按钮上传

**预期结果**:
- ✅ 所有文件都被解析
- ✅ 每个序列独立显示在项目树中
- ✅ 显示成功导入的数量

---

### 测试 10: 序列复制

**步骤**:
1. 右键点击一个序列
2. 选择"复制"
3. 检查是否创建了副本

**预期结果**:
- ✅ 创建 "序列名称 (copy)" 
- ✅ 包含所有特征和注释
- ✅ 两个序列独立

---

## 🔍 常见问题排查

### 问题 1: OVE 编辑器不显示

**检查**:
```bash
# 1. 确认依赖安装
cd frontend
npm list @teselagen/ove

# 2. 查看浏览器控制台错误
# 打开 F12 开发者工具
# 查看 Console 标签
```

**解决方法**:
```bash
# 重新安装
npm install --force @teselagen/ove
```

---

### 问题 2: 文件解析失败

**检查文件格式**:
```bash
# GenBank 文件应该包含:
head -20 your_file.gb
# 应该看到 LOCUS 开头

# FASTA 文件应该包含:
head -5 your_file.fasta
# 应该看到 > 开头
```

**调试**:
1. 打开浏览器控制台 (F12)
2. 查看解析错误详情
3. 检查文件编码 (应该是 UTF-8)

---

### 问题 3: 图谱不显示

**检查**:
1. 序列是否成功加载 (查看右侧属性面板)
2. 浏览器控制台是否有错误
3. 序列长度是否过大 (>1MB 可能很慢)

---

## 📊 性能测试

### 小文件 (<10KB)
- 导入时间: <1秒
- 图谱渲染: 即时
- 酶切分析: <1秒

### 中等文件 (10-100KB)
- 导入时间: 1-3秒
- 图谱渲染: <1秒
- 酶切分析: 1-2秒

### 大文件 (>100KB)
- 导入时间: 3-10秒
- 图谱渲染: 1-3秒
- 可能需要优化

---

## 🎯 功能验证矩阵

| 功能 | 测试方法 | 通过标准 | 状态 |
|------|---------|---------|------|
| GenBank 导入 | 拖拽 .gb 文件 | 自动解析显示 | ⬜ |
| FASTA 导入 | 拖拽 .fasta 文件 | 序列正确显示 | ⬜ |
| 环形图谱 | 打开质粒序列 | 圆形图显示 | ⬜ |
| 线性图谱 | 打开线性序列 | 直线图显示 | ⬜ |
| 酶切位点 | Tools → Cut Sites | 显示切点列表 | ⬜ |
| ORF 查找 | Tools → ORF | 显示 ORF 列表 | ⬜ |
| 特征编辑 | 选择添加特征 | 特征显示保存 | ⬜ |
| 导出 GB | 右键 → 导出 GB | 文件格式正确 | ⬜ |
| 导出 FASTA | 右键 → 导出 FASTA | 文件格式正确 | ⬜ |
| 批量导入 | 多文件上传 | 全部解析 | ⬜ |

---

## 🎬 视频演示脚本

### 场景 1: 完整工作流 (5分钟)

1. **打开应用** (0:00-0:10)
   - 启动 npm run dev
   - 打开浏览器

2. **导入质粒** (0:10-0:30)
   - 拖拽 pUC19.gb 到左侧
   - 展示自动解析过程

3. **查看图谱** (0:30-1:30)
   - 展示环形图谱
   - 缩放和旋转
   - 点击特征查看详情

4. **酶切分析** (1:30-2:30)
   - 打开 Cut Sites 工具
   - 选择常用酶
   - 展示切点标注

5. **编辑特征** (2:30-3:30)
   - 添加新的特征
   - 修改颜色和名称
   - 保存

6. **导出文件** (3:30-4:00)
   - 导出为 GenBank
   - 导出为 FASTA
   - 验证文件内容

7. **批量操作** (4:00-5:00)
   - 导入多个文件
   - 复制序列
   - 重命名和删除

---

## 📝 测试报告模板

```markdown
## 测试报告

**测试日期**: YYYY-MM-DD
**测试人员**: 
**浏览器**: Chrome/Firefox/Safari
**系统**: Windows/Mac/Linux

### 功能测试结果

| 功能 | 状态 | 备注 |
|------|------|------|
| 拖拽导入 | ✅/❌ | |
| 质粒图谱 | ✅/❌ | |
| 酶切分析 | ✅/❌ | |
| ORF 查找 | ✅/❌ | |
| 文件导出 | ✅/❌ | |

### 发现的问题

1. 问题描述
   - 重现步骤
   - 预期结果
   - 实际结果
   - 截图/错误信息

### 建议改进

1. 
2. 
3. 

### 总体评价

⭐⭐⭐⭐⭐ (5星满分)
```

---

## 🚀 快速验证脚本

```bash
#!/bin/bash
# 快速验证脚本

echo "🧪 BioLab Workbench 功能验证"
echo "=============================="

echo "📦 1. 检查依赖..."
cd frontend
npm list @teselagen/ove @teselagen/bio-parsers

echo "🏗️  2. 启动开发服务器..."
npm run dev &
DEV_PID=$!

echo "⏳ 等待服务器启动..."
sleep 5

echo "🌐 3. 打开浏览器..."
xdg-open http://localhost:5173 || open http://localhost:5173

echo "✅ 服务器已启动 (PID: $DEV_PID)"
echo "📝 请在浏览器中手动测试功能"
echo "⏹️  测试完成后,按 Ctrl+C 停止服务器"

wait $DEV_PID
```

---

## 📞 需要帮助?

如遇问题,请检查:
1. `GENEIOUS_UPGRADE_GUIDE.md` - 完整使用指南
2. 浏览器控制台 (F12) - 错误信息
3. 项目 Issues - 已知问题和解决方案

---

**最后更新**: 2024-12-16
**版本**: v2.0.0-geneious-upgrade